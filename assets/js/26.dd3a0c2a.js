(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{423:function(t,a,s){"use strict";s.r(a);var n=s(2),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"github-packages"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#github-packages"}},[t._v("#")]),t._v(" GitHub Packages")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://docs.github.com/en/packages",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Packages 文档"),a("OutboundLink")],1)]),t._v(" "),a("blockquote",[a("p",[t._v("学习安全地发布和使用包，将包与代码一起存储，并与您的团队私下或与开源社区公开共享您的包。您还可以使用 GitHub Actions 自动化您的包。\n说白的就是 github 注册列表的包管理器 ，而且不光有 npm  还有 Docker、Apache Maven 等")])]),t._v(" "),a("h3",{attrs:{id:"收费状况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#收费状况"}},[t._v("#")]),t._v(" 收费状况")]),t._v(" "),a("p",[t._v("GitHub Packages 对于公共仓库免费, 私人仓库就得花钱了->"),a("a",{attrs:{href:"https://docs.github.com/en/billing/managing-billing-for-github-packages/about-billing-for-github-packages",target:"_blank",rel:"noopener noreferrer"}},[t._v("收费状况"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"npm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm"}},[t._v("#")]),t._v(" npm")]),t._v(" "),a("p",[t._v("可以将 github 仓库发到 GitHub Packages 下的 npm 注册列表中, 当然下载包的时候需要使用  registry="),a("a",{attrs:{href:"https://npm.pkg.github.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://npm.pkg.github.com"),a("OutboundLink")],1)]),t._v(" "),a("h4",{attrs:{id:"发布包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#发布包"}},[t._v("#")]),t._v(" 发布包")]),t._v(" "),a("p",[t._v("目前来看只能使用 actions 进行发布，")]),t._v(" "),a("ul",[a("li",[t._v("首先创建一个github仓库 ，我使用我的"),a("a",{attrs:{href:"https://github.com/bitbw/rollup-typescript-babel-eslint",target:"_blank",rel:"noopener noreferrer"}},[t._v("rollup模板"),a("OutboundLink")],1),t._v("创建一个")]),t._v(" "),a("li",[t._v("创建 "),a("a",{attrs:{href:"https://docs.github.com/en/actions/quickstart",target:"_blank",rel:"noopener noreferrer"}},[t._v("actions"),a("OutboundLink")],1),t._v(",现在创建比较简单，点击 Action -> 点击 new workflow -> 在推荐的配置中找到 Publish Node.js Package to GitHub Packages，")]),t._v(" "),a("li",[t._v("修改 workflow配置")])]),t._v(" "),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This workflow will run tests using node and then publish a package to GitHub Packages when a release is created")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# For more information see: https://docs.github.com/en/actions/publishing-packages/publishing-nodejs-packages")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Node.js Package\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branches")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" main\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("publish-gpr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("NODE_AUTH_TOKEN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("secrets.GITHUB_TOKEN"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里不用改")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("permissions")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("contents")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" read\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("packages")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" write "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 必须有 packages 的可写权")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v3\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/setup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("node@v3\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node-version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("registry-url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//npm.pkg.github.com/ "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 发布到 github 下的 npm 仓库")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm ci\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm run build\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Test\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token scalar string"}},[t._v("\n          echo =============env==============\n          env | grep NODE_AUTH_TOKEN\n          echo =============ls hla==============\n          ls -hla \n          ls dist")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" publish\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm publish\n")])])]),a("ul",[a("li",[t._v("修改一下 package.json 中的name 添加，命名空间 "),a("code",[t._v('name": "@bitbw/github-package-test-bitbw",')]),t._v(" 我的需要添加"),a("code",[t._v("@bitbw/")])]),t._v(" "),a("li",[t._v("查看流水线是否完成 ，没有报错说明发包成功了，可以去自己的 packages 列表查看了")])]),t._v(" "),a("h4",{attrs:{id:"下载包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载包"}},[t._v("#")]),t._v(" 下载包")]),t._v(" "),a("ul",[a("li",[t._v("在需要下载的目录下创建 .npmrc 添加以下配置")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("registry=https://npm.pkg.github.com\n//npm.pkg.github.com/:_authToken=TODO\n")])])]),a("ul",[a("li",[t._v("_authToken 通过 "),a("a",{attrs:{href:"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token",target:"_blank",rel:"noopener noreferrer"}},[t._v("创建个人访问令牌获取"),a("OutboundLink")],1),t._v(",需要有read:packages权限才能下载")]),t._v(" "),a("li",[t._v("下载 npm install  @bitbw/github-package-test-bitbw")])])])}),[],!1,null,null,null);a.default=e.exports}}]);